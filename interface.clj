;; gorilla-repl.fileformat = 1

;; **
;;; # Gorilla REPL
;; **

;; **
;;; Load in libraries and core functions.
;; **

;; @@
(use '[clojure repl pprint walk])
(use '[clojure.zip :as zip])
(use 'gorilla-plot.core)
(use '[gorilla-repl table html])
(use 'sym-regression-project.render :reload)
(use 'sym-regression-project.core :reload)
(require '[clojure.java.io :as io])
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(defn read-from-file [filename]
  "Function that reads from a file specified by filename"
	  (with-open [r (java.io.PushbackReader.
	                 (clojure.java.io/reader filename))]
	    (binding [*read-eval* false]
	      (read r))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/read-from-file</span>","value":"#'user/read-from-file"}
;; <=

;; @@
(io/delete-file "data.txt")
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-unkown'>true</span>","value":"true"}
;; <=

;; **
;;; Define a test function.
;; **

;; @@
(def domain-step 0.5)

;(def data (doall (map (fn [x] [x (+ (* 3 x) (* 2 x x))]) (range 0 10 0.5))))
(def data (doall (map (fn [x] [x (Math/sin x)]) (range 0 10 domain-step))))
;(def data (doall (map (fn [x] [x (* 0.01 (+ x 0.5) (+ x 1) (- x 5) (+ x 10))]) (range -5 7 domain-step))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/data</span>","value":"#'user/data"}
;; <=

;; @@
(list-plot data)
;; @@
;; =>
;;; {"type":"vega","content":{"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"06a1a696-3ead-45ba-abd8-9be973ba7d11","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"06a1a696-3ead-45ba-abd8-9be973ba7d11","field":"data.y"}}],"marks":[{"type":"symbol","from":{"data":"06a1a696-3ead-45ba-abd8-9be973ba7d11"},"properties":{"enter":{"x":{"field":"data.x","scale":"x"},"y":{"field":"data.y","scale":"y"},"fill":{"value":"steelblue"},"fillOpacity":{"value":1}},"update":{"shape":"circle","size":{"value":70},"stroke":{"value":"transparent"}},"hover":{"size":{"value":210},"stroke":{"value":"white"}}}}],"data":[{"name":"06a1a696-3ead-45ba-abd8-9be973ba7d11","values":[{"x":0,"y":0.0},{"x":0.5,"y":0.479425538604203},{"x":1.0,"y":0.8414709848078965},{"x":1.5,"y":0.9974949866040544},{"x":2.0,"y":0.9092974268256817},{"x":2.5,"y":0.5984721441039564},{"x":3.0,"y":0.1411200080598672},{"x":3.5,"y":-0.35078322768961984},{"x":4.0,"y":-0.7568024953079282},{"x":4.5,"y":-0.977530117665097},{"x":5.0,"y":-0.9589242746631385},{"x":5.5,"y":-0.7055403255703919},{"x":6.0,"y":-0.27941549819892586},{"x":6.5,"y":0.21511998808781552},{"x":7.0,"y":0.6569865987187891},{"x":7.5,"y":0.9379999767747389},{"x":8.0,"y":0.9893582466233818},{"x":8.5,"y":0.7984871126234903},{"x":9.0,"y":0.4121184852417566},{"x":9.5,"y":-0.0751511204618093}]}],"width":400,"height":247.2187957763672,"padding":{"bottom":20,"top":10,"right":10,"left":50}},"value":"#gorilla_repl.vega.VegaView{:content {:axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"06a1a696-3ead-45ba-abd8-9be973ba7d11\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"06a1a696-3ead-45ba-abd8-9be973ba7d11\", :field \"data.y\"}}], :marks [{:type \"symbol\", :from {:data \"06a1a696-3ead-45ba-abd8-9be973ba7d11\"}, :properties {:enter {:x {:field \"data.x\", :scale \"x\"}, :y {:field \"data.y\", :scale \"y\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 1}}, :update {:shape \"circle\", :size {:value 70}, :stroke {:value \"transparent\"}}, :hover {:size {:value 210}, :stroke {:value \"white\"}}}}], :data [{:name \"06a1a696-3ead-45ba-abd8-9be973ba7d11\", :values ({:x 0, :y 0.0} {:x 0.5, :y 0.479425538604203} {:x 1.0, :y 0.8414709848078965} {:x 1.5, :y 0.9974949866040544} {:x 2.0, :y 0.9092974268256817} {:x 2.5, :y 0.5984721441039564} {:x 3.0, :y 0.1411200080598672} {:x 3.5, :y -0.35078322768961984} {:x 4.0, :y -0.7568024953079282} {:x 4.5, :y -0.977530117665097} {:x 5.0, :y -0.9589242746631385} {:x 5.5, :y -0.7055403255703919} {:x 6.0, :y -0.27941549819892586} {:x 6.5, :y 0.21511998808781552} {:x 7.0, :y 0.6569865987187891} {:x 7.5, :y 0.9379999767747389} {:x 8.0, :y 0.9893582466233818} {:x 8.5, :y 0.7984871126234903} {:x 9.0, :y 0.4121184852417566} {:x 9.5, :y -0.0751511204618093})}], :width 400, :height 247.2188, :padding {:bottom 20, :top 10, :right 10, :left 50}}}"}
;; <=

;; @@
(def dxdy (numerical-derivative data domain-step))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/dxdy</span>","value":"#'user/dxdy"}
;; <=

;; @@
(compose
 (list-plot dxdy)
 (plot (functionalise '(Math/cos x)) [0 10]))
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"bottom":20,"top":10,"right":10,"left":50},"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"b68043d9-30a4-44ea-ac82-24435211af3e","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"b68043d9-30a4-44ea-ac82-24435211af3e","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}],"data":[{"name":"b68043d9-30a4-44ea-ac82-24435211af3e","values":[{"x":0.5,"y":0.8414709848078965},{"x":1.0,"y":0.5180694479998514},{"x":1.5,"y":0.0678264420177852},{"x":2.0,"y":-0.399022842500098},{"x":2.5,"y":-0.7681774187658145},{"x":3.0,"y":-0.9492553717935763},{"x":3.5,"y":-0.8979225033677954},{"x":4.0,"y":-0.6267468899754771},{"x":4.5,"y":-0.20212177935521025},{"x":5.0,"y":0.2719897920947051},{"x":5.5,"y":0.6795087764642126},{"x":6.0,"y":0.9206603136582074},{"x":6.5,"y":0.9364020969177149},{"x":7.0,"y":0.7228799886869234},{"x":7.5,"y":0.3323716479045927},{"x":8.0,"y":-0.13951286415124864},{"x":8.5,"y":-0.5772397613816251},{"x":9.0,"y":-0.8736382330852995}]},{"name":"3ff05770-591c-44f7-ba07-32000557af64","values":[{"x":0,"y":1.0},{"x":0.10000000149011612,"y":0.9950041651292624},{"x":0.20000000298023224,"y":0.9800665772491609},{"x":0.30000000447034836,"y":0.9553364878045277},{"x":0.4000000059604645,"y":0.9210609916817709},{"x":0.5000000074505806,"y":0.8775825583183741},{"x":0.6000000089406967,"y":0.8253356098613811},{"x":0.7000000104308128,"y":0.7648421805647743},{"x":0.800000011920929,"y":0.6967067007956144},{"x":0.9000000134110451,"y":0.6216099577654319},{"x":1.0000000149011612,"y":0.5403022933292448},{"x":1.1000000163912773,"y":0.45359610681755036},{"x":1.2000000178813934,"y":0.36235773781051595},{"x":1.3000000193715096,"y":0.26749880995901076},{"x":1.4000000208616257,"y":0.16996712234215752},{"x":1.5000000223517418,"y":0.07073717937195251},{"x":1.600000023841858,"y":-0.029199546132980533},{"x":1.700000025331974,"y":-0.12884451941635186},{"x":1.8000000268220901,"y":-0.2272021208137159},{"x":1.9000000283122063,"y":-0.32328959365534654},{"x":2.0000000298023224,"y":-0.41614686364631726},{"x":2.1000000312924385,"y":-0.5048461316117833},{"x":2.2000000327825546,"y":-0.5885011437599229},{"x":2.3000000342726707,"y":-0.666276046837133},{"x":2.400000035762787,"y":-0.7373937396976907},{"x":2.500000037252903,"y":-0.8011436378417579},{"x":2.600000038743019,"y":-0.8568887733410261},{"x":2.7000000402331352,"y":-0.9040721592118929},{"x":2.8000000417232513,"y":-0.9422223546454521},{"x":2.9000000432133675,"y":-0.9709581754883588},{"x":3.0000000447034836,"y":-0.9899925029090004},{"x":3.1000000461935997,"y":-0.9991351521940389},{"x":3.200000047683716,"y":-0.9982947730112559},{"x":3.300000049173832,"y":-0.9874797621519035},{"x":3.400000050663948,"y":-0.9667981796327386},{"x":3.500000052154064,"y":-0.9364566689960241},{"x":3.6000000536441803,"y":-0.8967583925954993},{"x":3.7000000551342964,"y":-0.848100002498264},{"x":3.8000000566244125,"y":-0.7909676772683218},{"x":3.9000000581145287,"y":-0.7259322642309327},{"x":4.000000059604645,"y":-0.6536435757546668},{"x":4.100000061094761,"y":-0.5748238965408234},{"x":4.200000062584877,"y":-0.4902607667932361},{"x":4.300000064074993,"y":-0.40079911337664836},{"x":4.400000065565109,"y":-0.3073328075865251},{"x":4.500000067055225,"y":-0.21079573388227688},{"x":4.6000000685453415,"y":-0.11215245882216507},{"x":4.700000070035458,"y":-0.012388593432807788},{"x":4.800000071525574,"y":0.08749905469069152},{"x":4.90000007301569,"y":0.18651244115703017},{"x":5.000000074505806,"y":0.28366225690865143},{"x":5.100000075995922,"y":0.37797781307111994},{"x":5.200000077486038,"y":0.4685167397557768},{"x":5.300000078976154,"y":0.5543744019084411},{"x":5.4000000804662704,"y":0.6346929381241085},{"x":5.500000081956387,"y":0.7086698321147933},{"x":5.600000083446503,"y":0.7755659311872403},{"x":5.700000084936619,"y":0.8347128316125247},{"x":5.800000086426735,"y":0.8855195570953651},{"x":5.900000087916851,"y":0.9274784636140913},{"x":6.000000089406967,"y":0.9601703116320545},{"x":6.100000090897083,"y":0.9832684550006209},{"x":6.200000092387199,"y":0.9965421046996105},{"x":6.3000000938773155,"y":0.999858634804967},{"x":6.400000095367432,"y":0.9931849076431898},{"x":6.500000096857548,"y":0.9765876048920245},{"x":6.600000098347664,"y":0.9502325613191596},{"x":6.70000009983778,"y":0.9143831078159975},{"x":6.800000101327896,"y":0.8693974402823544},{"x":6.900000102818012,"y":0.815725040651326},{"x":7.000000104308128,"y":0.753902185814258},{"x":7.1000001057982445,"y":0.6845465893191578},{"x":7.200000107288361,"y":0.6083512293809272},{"x":7.300000108778477,"y":0.5260774248719019},{"x":7.400000110268593,"y":0.4385472284751109},{"x":7.500000111758709,"y":0.34663521300535727},{"x":7.600000113248825,"y":0.2512597329664881},{"x":7.700000114738941,"y":0.15337374865648665},{"x":7.800000116229057,"y":0.05395530450289749},{"x":7.900000117719173,"y":-0.04600224323408535},{"x":8.00000011920929,"y":-0.1455001517493062},{"x":8.100000120699406,"y":-0.24354427080091343},{"x":8.200000122189522,"y":-0.33915497593124955},{"x":8.300000123679638,"y":-0.4313769565509026},{"x":8.400000125169754,"y":-0.5192887610866164},{"x":8.50000012665987,"y":-0.6020120038210928},{"x":8.600000128149986,"y":-0.6787201414329851},{"x":8.700000129640102,"y":-0.7486467315447918},{"x":8.800000131130219,"y":-0.8110930907619679},{"x":8.900000132620335,"y":-0.8654352756866581},{"x":9.00000013411045,"y":-0.9111303171540646},{"x":9.100000135600567,"y":-0.9477216454010221},{"x":9.200000137090683,"y":-0.9748436519602851},{"x":9.300000138580799,"y":-0.9922253426995873},{"x":9.400000140070915,"y":-0.9996930455055132},{"x":9.500000141561031,"y":-0.9971721455578983},{"x":9.600000143051147,"y":-0.9846878308564707},{"x":9.700000144541264,"y":-0.9623648405506756},{"x":9.80000014603138,"y":-0.9304262185872907},{"x":9.900000147521496,"y":-0.8891910851289719}]}],"marks":[{"type":"symbol","from":{"data":"b68043d9-30a4-44ea-ac82-24435211af3e"},"properties":{"enter":{"x":{"field":"data.x","scale":"x"},"y":{"field":"data.y","scale":"y"},"fill":{"value":"steelblue"},"fillOpacity":{"value":1}},"update":{"shape":"circle","size":{"value":70},"stroke":{"value":"transparent"}},"hover":{"size":{"value":210},"stroke":{"value":"white"}}}},{"type":"line","from":{"data":"3ff05770-591c-44f7-ba07-32000557af64"},"properties":{"enter":{"x":{"field":"data.x","scale":"x"},"y":{"field":"data.y","scale":"y"},"stroke":{"value":"#FF29D2"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:bottom 20, :top 10, :right 10, :left 50}, :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"b68043d9-30a4-44ea-ac82-24435211af3e\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"b68043d9-30a4-44ea-ac82-24435211af3e\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}], :data ({:name \"b68043d9-30a4-44ea-ac82-24435211af3e\", :values ({:x 0.5, :y 0.8414709848078965} {:x 1.0, :y 0.5180694479998514} {:x 1.5, :y 0.0678264420177852} {:x 2.0, :y -0.399022842500098} {:x 2.5, :y -0.7681774187658145} {:x 3.0, :y -0.9492553717935763} {:x 3.5, :y -0.8979225033677954} {:x 4.0, :y -0.6267468899754771} {:x 4.5, :y -0.20212177935521025} {:x 5.0, :y 0.2719897920947051} {:x 5.5, :y 0.6795087764642126} {:x 6.0, :y 0.9206603136582074} {:x 6.5, :y 0.9364020969177149} {:x 7.0, :y 0.7228799886869234} {:x 7.5, :y 0.3323716479045927} {:x 8.0, :y -0.13951286415124864} {:x 8.5, :y -0.5772397613816251} {:x 9.0, :y -0.8736382330852995})} {:name \"3ff05770-591c-44f7-ba07-32000557af64\", :values ({:x 0, :y 1.0} {:x 0.10000000149011612, :y 0.9950041651292624} {:x 0.20000000298023224, :y 0.9800665772491609} {:x 0.30000000447034836, :y 0.9553364878045277} {:x 0.4000000059604645, :y 0.9210609916817709} {:x 0.5000000074505806, :y 0.8775825583183741} {:x 0.6000000089406967, :y 0.8253356098613811} {:x 0.7000000104308128, :y 0.7648421805647743} {:x 0.800000011920929, :y 0.6967067007956144} {:x 0.9000000134110451, :y 0.6216099577654319} {:x 1.0000000149011612, :y 0.5403022933292448} {:x 1.1000000163912773, :y 0.45359610681755036} {:x 1.2000000178813934, :y 0.36235773781051595} {:x 1.3000000193715096, :y 0.26749880995901076} {:x 1.4000000208616257, :y 0.16996712234215752} {:x 1.5000000223517418, :y 0.07073717937195251} {:x 1.600000023841858, :y -0.029199546132980533} {:x 1.700000025331974, :y -0.12884451941635186} {:x 1.8000000268220901, :y -0.2272021208137159} {:x 1.9000000283122063, :y -0.32328959365534654} {:x 2.0000000298023224, :y -0.41614686364631726} {:x 2.1000000312924385, :y -0.5048461316117833} {:x 2.2000000327825546, :y -0.5885011437599229} {:x 2.3000000342726707, :y -0.666276046837133} {:x 2.400000035762787, :y -0.7373937396976907} {:x 2.500000037252903, :y -0.8011436378417579} {:x 2.600000038743019, :y -0.8568887733410261} {:x 2.7000000402331352, :y -0.9040721592118929} {:x 2.8000000417232513, :y -0.9422223546454521} {:x 2.9000000432133675, :y -0.9709581754883588} {:x 3.0000000447034836, :y -0.9899925029090004} {:x 3.1000000461935997, :y -0.9991351521940389} {:x 3.200000047683716, :y -0.9982947730112559} {:x 3.300000049173832, :y -0.9874797621519035} {:x 3.400000050663948, :y -0.9667981796327386} {:x 3.500000052154064, :y -0.9364566689960241} {:x 3.6000000536441803, :y -0.8967583925954993} {:x 3.7000000551342964, :y -0.848100002498264} {:x 3.8000000566244125, :y -0.7909676772683218} {:x 3.9000000581145287, :y -0.7259322642309327} {:x 4.000000059604645, :y -0.6536435757546668} {:x 4.100000061094761, :y -0.5748238965408234} {:x 4.200000062584877, :y -0.4902607667932361} {:x 4.300000064074993, :y -0.40079911337664836} {:x 4.400000065565109, :y -0.3073328075865251} {:x 4.500000067055225, :y -0.21079573388227688} {:x 4.6000000685453415, :y -0.11215245882216507} {:x 4.700000070035458, :y -0.012388593432807788} {:x 4.800000071525574, :y 0.08749905469069152} {:x 4.90000007301569, :y 0.18651244115703017} {:x 5.000000074505806, :y 0.28366225690865143} {:x 5.100000075995922, :y 0.37797781307111994} {:x 5.200000077486038, :y 0.4685167397557768} {:x 5.300000078976154, :y 0.5543744019084411} {:x 5.4000000804662704, :y 0.6346929381241085} {:x 5.500000081956387, :y 0.7086698321147933} {:x 5.600000083446503, :y 0.7755659311872403} {:x 5.700000084936619, :y 0.8347128316125247} {:x 5.800000086426735, :y 0.8855195570953651} {:x 5.900000087916851, :y 0.9274784636140913} {:x 6.000000089406967, :y 0.9601703116320545} {:x 6.100000090897083, :y 0.9832684550006209} {:x 6.200000092387199, :y 0.9965421046996105} {:x 6.3000000938773155, :y 0.999858634804967} {:x 6.400000095367432, :y 0.9931849076431898} {:x 6.500000096857548, :y 0.9765876048920245} {:x 6.600000098347664, :y 0.9502325613191596} {:x 6.70000009983778, :y 0.9143831078159975} {:x 6.800000101327896, :y 0.8693974402823544} {:x 6.900000102818012, :y 0.815725040651326} {:x 7.000000104308128, :y 0.753902185814258} {:x 7.1000001057982445, :y 0.6845465893191578} {:x 7.200000107288361, :y 0.6083512293809272} {:x 7.300000108778477, :y 0.5260774248719019} {:x 7.400000110268593, :y 0.4385472284751109} {:x 7.500000111758709, :y 0.34663521300535727} {:x 7.600000113248825, :y 0.2512597329664881} {:x 7.700000114738941, :y 0.15337374865648665} {:x 7.800000116229057, :y 0.05395530450289749} {:x 7.900000117719173, :y -0.04600224323408535} {:x 8.00000011920929, :y -0.1455001517493062} {:x 8.100000120699406, :y -0.24354427080091343} {:x 8.200000122189522, :y -0.33915497593124955} {:x 8.300000123679638, :y -0.4313769565509026} {:x 8.400000125169754, :y -0.5192887610866164} {:x 8.50000012665987, :y -0.6020120038210928} {:x 8.600000128149986, :y -0.6787201414329851} {:x 8.700000129640102, :y -0.7486467315447918} {:x 8.800000131130219, :y -0.8110930907619679} {:x 8.900000132620335, :y -0.8654352756866581} {:x 9.00000013411045, :y -0.9111303171540646} {:x 9.100000135600567, :y -0.9477216454010221} {:x 9.200000137090683, :y -0.9748436519602851} {:x 9.300000138580799, :y -0.9922253426995873} {:x 9.400000140070915, :y -0.9996930455055132} {:x 9.500000141561031, :y -0.9971721455578983} {:x 9.600000143051147, :y -0.9846878308564707} {:x 9.700000144541264, :y -0.9623648405506756} {:x 9.80000014603138, :y -0.9304262185872907} {:x 9.900000147521496, :y -0.8891910851289719})}), :marks ({:type \"symbol\", :from {:data \"b68043d9-30a4-44ea-ac82-24435211af3e\"}, :properties {:enter {:x {:field \"data.x\", :scale \"x\"}, :y {:field \"data.y\", :scale \"y\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 1}}, :update {:shape \"circle\", :size {:value 70}, :stroke {:value \"transparent\"}}, :hover {:size {:value 210}, :stroke {:value \"white\"}}}} {:type \"line\", :from {:data \"3ff05770-591c-44f7-ba07-32000557af64\"}, :properties {:enter {:x {:field \"data.x\", :scale \"x\"}, :y {:field \"data.y\", :scale \"y\"}, :stroke {:value \"#FF29D2\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}})}}"}
;; <=

;; **
;;; Program configuration.
;; **

;; @@
(defn evolve
  [population config]
  (let [{:keys [score-1-func score-2-func mutation-new-tree-func tournament-size clone-n mutate-n crossover-n max-archive-size
                report-num]} config
       
        generation-number (inc (:gen-num (first population))) 
        generation {:gen-num generation-number}
        
        popu-without-gen (if (not (nil? (:gen-num (first population)))) (drop 1 population) population)
        previous-archive (filter #(true? (:archived %)) popu-without-gen)
        
        objective-scored-popn (score-population (filter #(nil? (:archived %)) popu-without-gen) score-1-func score-2-func)
        archive (flatten (cons previous-archive (map #(merge  {:archived true} %) (flatten (into-archive should-be-archived is-dominated objective-scored-popn objective-scored-popn)))))
        c-archive (into () (distinct (flatten (into-archive should-be-archived is-dominated archive archive))))
       
        ; insert function that removes different expressions with same score...
        archive-coords (distinct (map #(extract-coords %) c-archive))
        checked-archive (map #(remove-repeats c-archive %) archive-coords)
        
        
        archive-size (count checked-archive)
        thinned-archive (thinning-done thin-archive find-min-distance distance-calcs checked-archive archive-size max-archive-size)
        
        
        
        scored-archive (map #(strength-func % objective-scored-popn) thinned-archive)
        scored-true-popn (map #(fitness-population % scored-archive) objective-scored-popn)
        population-for-selection (flatten (cons scored-archive scored-true-popn))
       
        clones (repeatedly clone-n #(tournament-selector population-for-selection tournament-size))
        mutations (repeatedly mutate-n 
                              #(mutate-expr 
                                (tournament-selector population-for-selection tournament-size)
                                mutation-new-tree-func))
        crossovers (reduce into (repeatedly crossover-n
                               #(crossover-expr
                                 (tournament-selector population-for-selection tournament-size)
                                 (tournament-selector population-for-selection tournament-size))))]
    
     (if (= (rem generation-number report-num) 0) (println generation) ())
     
    ; uncomment for indication of thinning time.
    ;(time (thinning-done thin-archive find-min-distance distance-calcs checked-archive archive-size max-archive-size))
    
    (spit "data.txt" population)
    
    (cons generation (into thinned-archive (into clones (into mutations crossovers))))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/evolve</span>","value":"#'user/evolve"}
;; <=

;; @@
(def config {
             :score-1-func (memoize #(score-1 data %))
             :score-2-func (memoize #(score-2 count-nodes %))
             :mutation-new-tree-func #(random-full-tree functions terminals 3)
             :tournament-size 2
             :clone-n 40
             :crossover-n 25
             :mutate-n 10
             :max-archive-size 20
             :report-num 5})
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/config</span>","value":"#'user/config"}
;; <=

;; @@
;; Generate an initial population (default size 100).
;(def init-pop (read-from-file "data.txt"))
(def init-pop (cons {:gen-num 1} (repeatedly 100 #(random-full-tree functions terminals 3))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/init-pop</span>","value":"#'user/init-pop"}
;; <=

;; @@
;; Run algorithm and time (default loop 20 times).
(time (def run-data (doall (take 50 (iterate #(evolve % config) init-pop)))))
;; @@
;; ->
;;; {:gen-num 5}
;;; {:gen-num 10}
;;; {:gen-num 15}
;;; {:gen-num 20}
;;; {:gen-num 25}
;;; {:gen-num 30}
;;; {:gen-num 35}
;;; {:gen-num 40}
;;; {:gen-num 45}
;;; {:gen-num 50}
;;; &quot;Elapsed time: 4234.371632 msecs&quot;
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/run-data</span>","value":"#'user/run-data"}
;; <=

;; **
;;; Analyse results of symbolic regression.
;; **

;; @@

;; Remove generation numbers from each generation
(defn filter-out-generation-num
  [generation]
(filter #(nil? (:gen-num %)) generation))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/filter-out-generation-num</span>","value":"#'user/filter-out-generation-num"}
;; <=

;; @@
;; Remove all archived expressions from each generation.
(defn filter-out-archive
  [generation]
  (filter #(nil? (:archived %)) generation))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/filter-out-archive</span>","value":"#'user/filter-out-archive"}
;; <=

;; @@
(defn best-in-generation-1
  [popn score-1-func score-2-func]
  (apply max-key :score-1 (score-population popn score-1-func score-2-func)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/best-in-generation-1</span>","value":"#'user/best-in-generation-1"}
;; <=

;; @@
(defn best-in-generation-2
  [popn score-1-func score-2-func]
  (apply max-key :score-2 (score-population popn score-1-func score-2-func)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/best-in-generation-2</span>","value":"#'user/best-in-generation-2"}
;; <=

;; @@
(def individuals (map #(filter-out-generation-num %) run-data))
(def all-individuals (map #(filter-out-archive %) individuals))
(def final-archive (filter #(true? (:archived %)) (last individuals)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/final-archive</span>","value":"#'user/final-archive"}
;; <=

;; @@
(def bests-1 (doall (map #(best-in-generation-1 % (:score-1-func config) (:score-2-func config)) all-individuals)))
(list-plot (map :score-1 bests-1) :joined true)
;; @@
;; =>
;;; {"type":"vega","content":{"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"445f01e3-f9b2-4f55-b885-014d42c35eae","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"445f01e3-f9b2-4f55-b885-014d42c35eae","field":"data.y"}}],"marks":[{"type":"line","from":{"data":"445f01e3-f9b2-4f55-b885-014d42c35eae"},"properties":{"enter":{"x":{"field":"data.x","scale":"x"},"y":{"field":"data.y","scale":"y"},"stroke":{"value":"#FF29D2"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}],"data":[{"name":"445f01e3-f9b2-4f55-b885-014d42c35eae","values":[{"x":0,"y":-1.2810370001386249},{"x":1,"y":-1.2810370001386249},{"x":2,"y":-0.0},{"x":3,"y":-0.0},{"x":4,"y":-0.0},{"x":5,"y":-0.0},{"x":6,"y":-0.0},{"x":7,"y":-0.0},{"x":8,"y":-0.0},{"x":9,"y":-0.0},{"x":10,"y":-0.0},{"x":11,"y":-0.0},{"x":12,"y":-0.0},{"x":13,"y":-0.0},{"x":14,"y":-0.0},{"x":15,"y":-0.0},{"x":16,"y":-0.0},{"x":17,"y":-0.0},{"x":18,"y":-0.0},{"x":19,"y":-0.0},{"x":20,"y":-0.0},{"x":21,"y":-0.0},{"x":22,"y":-0.0},{"x":23,"y":-0.0},{"x":24,"y":-0.0},{"x":25,"y":-0.0},{"x":26,"y":-0.0},{"x":27,"y":-0.0},{"x":28,"y":-0.0},{"x":29,"y":-0.0},{"x":30,"y":-0.0},{"x":31,"y":-0.0},{"x":32,"y":-0.0},{"x":33,"y":-0.0},{"x":34,"y":-0.0},{"x":35,"y":-0.0},{"x":36,"y":-0.0},{"x":37,"y":-0.0},{"x":38,"y":-0.0},{"x":39,"y":-0.0},{"x":40,"y":-0.0},{"x":41,"y":-0.0},{"x":42,"y":-0.0},{"x":43,"y":-0.0},{"x":44,"y":-0.0},{"x":45,"y":-0.0},{"x":46,"y":-0.0},{"x":47,"y":-0.0},{"x":48,"y":-0.0},{"x":49,"y":-0.0}]}],"width":400,"height":247.2187957763672,"padding":{"bottom":20,"top":10,"right":10,"left":50}},"value":"#gorilla_repl.vega.VegaView{:content {:axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"445f01e3-f9b2-4f55-b885-014d42c35eae\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"445f01e3-f9b2-4f55-b885-014d42c35eae\", :field \"data.y\"}}], :marks [{:type \"line\", :from {:data \"445f01e3-f9b2-4f55-b885-014d42c35eae\"}, :properties {:enter {:x {:field \"data.x\", :scale \"x\"}, :y {:field \"data.y\", :scale \"y\"}, :stroke {:value \"#FF29D2\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}}], :data [{:name \"445f01e3-f9b2-4f55-b885-014d42c35eae\", :values ({:x 0, :y -1.2810370001386249} {:x 1, :y -1.2810370001386249} {:x 2, :y -0.0} {:x 3, :y -0.0} {:x 4, :y -0.0} {:x 5, :y -0.0} {:x 6, :y -0.0} {:x 7, :y -0.0} {:x 8, :y -0.0} {:x 9, :y -0.0} {:x 10, :y -0.0} {:x 11, :y -0.0} {:x 12, :y -0.0} {:x 13, :y -0.0} {:x 14, :y -0.0} {:x 15, :y -0.0} {:x 16, :y -0.0} {:x 17, :y -0.0} {:x 18, :y -0.0} {:x 19, :y -0.0} {:x 20, :y -0.0} {:x 21, :y -0.0} {:x 22, :y -0.0} {:x 23, :y -0.0} {:x 24, :y -0.0} {:x 25, :y -0.0} {:x 26, :y -0.0} {:x 27, :y -0.0} {:x 28, :y -0.0} {:x 29, :y -0.0} {:x 30, :y -0.0} {:x 31, :y -0.0} {:x 32, :y -0.0} {:x 33, :y -0.0} {:x 34, :y -0.0} {:x 35, :y -0.0} {:x 36, :y -0.0} {:x 37, :y -0.0} {:x 38, :y -0.0} {:x 39, :y -0.0} {:x 40, :y -0.0} {:x 41, :y -0.0} {:x 42, :y -0.0} {:x 43, :y -0.0} {:x 44, :y -0.0} {:x 45, :y -0.0} {:x 46, :y -0.0} {:x 47, :y -0.0} {:x 48, :y -0.0} {:x 49, :y -0.0})}], :width 400, :height 247.2188, :padding {:bottom 20, :top 10, :right 10, :left 50}}}"}
;; <=

;; @@
;; scored-generations maps the score-population function over every generation.
(def scored-generations (doall (map #(score-population % (:score-1-func config) (:score-2-func config)) all-individuals)))

;; final-generation outputs the scored expressions from the very last iteration.
(def final-generation (last scored-generations))

;; scored-individuals returns a sequence of every scored individual.
(def scored-individuals (flatten scored-generations))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/scored-individuals</span>","value":"#'user/scored-individuals"}
;; <=

;; @@
(def unarchived (map #(merge % {:archived false}) final-archive))

(def pareto-front-gen (map #(merge % {:archived false}) (into () (set (flatten (into-archive should-be-archived is-dominated final-generation final-generation))))))


(def pareto-front-individuals (distinct (into () (set (flatten (into-archive should-be-archived is-dominated unarchived pareto-front-gen))))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/pareto-front-individuals</span>","value":"#'user/pareto-front-individuals"}
;; <=

;; @@
;; Generate a graph showing the individual from the final generation that has the highest score-1 value.
(compose
 (list-plot data)
 (plot (functionalise (:expr (apply max-key :score-1 pareto-front-individuals))) [0 10]))
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"bottom":20,"top":10,"right":10,"left":50},"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"d604fcd7-3072-4872-a662-e69c418a323d","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"d604fcd7-3072-4872-a662-e69c418a323d","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}],"data":[{"name":"d604fcd7-3072-4872-a662-e69c418a323d","values":[{"x":0,"y":0.0},{"x":0.5,"y":0.479425538604203},{"x":1.0,"y":0.8414709848078965},{"x":1.5,"y":0.9974949866040544},{"x":2.0,"y":0.9092974268256817},{"x":2.5,"y":0.5984721441039564},{"x":3.0,"y":0.1411200080598672},{"x":3.5,"y":-0.35078322768961984},{"x":4.0,"y":-0.7568024953079282},{"x":4.5,"y":-0.977530117665097},{"x":5.0,"y":-0.9589242746631385},{"x":5.5,"y":-0.7055403255703919},{"x":6.0,"y":-0.27941549819892586},{"x":6.5,"y":0.21511998808781552},{"x":7.0,"y":0.6569865987187891},{"x":7.5,"y":0.9379999767747389},{"x":8.0,"y":0.9893582466233818},{"x":8.5,"y":0.7984871126234903},{"x":9.0,"y":0.4121184852417566},{"x":9.5,"y":-0.0751511204618093}]},{"name":"4a73e3f3-739c-4767-be48-f4ca93779c83","values":[{"x":0,"y":0.0},{"x":0.10000000149011612,"y":0.0998334181294999},{"x":0.20000000298023224,"y":0.19866933371588721},{"x":0.30000000447034836,"y":0.29552021093202646},{"x":0.4000000059604645,"y":0.3894183477986018},{"x":0.5000000074505806,"y":0.4794255451427026},{"x":0.6000000089406967,"y":0.5646424807741107},{"x":0.7000000104308128,"y":0.6442176952156167},{"x":0.800000011920929,"y":0.7173560992049138},{"x":0.9000000134110451,"y":0.7833269179639226},{"x":1.0000000149011612,"y":0.8414709928590282},{"x":1.1000000163912773,"y":0.891207367496455},{"x":1.2000000178813934,"y":0.9320390924466878},{"x":1.3000000193715096,"y":0.9635581905990489},{"x":1.4000000208616257,"y":0.9854497335342509},{"x":1.5000000223517418,"y":0.9974949881851538},{"x":1.600000023841858,"y":0.999573602345334},{"x":1.700000025331974,"y":0.991664807188583},{"x":1.8000000268220901,"y":0.9738476247841598},{"x":1.9000000283122063,"y":0.9463000785343733},{"x":2.0000000298023224,"y":0.9092974144235391},{"x":2.1000000312924385,"y":0.8632093508510077},{"x":2.2000000327825546,"y":0.8084963845270198},{"x":2.3000000342726707,"y":0.7457051893416611},{"x":2.400000035762787,"y":0.6754631541798962},{"x":2.500000037252903,"y":0.5984721142590307},{"x":2.600000038743019,"y":0.5155013386230065},{"x":2.7000000402331352,"y":0.42737984386017286},{"x":2.8000000417232513,"y":0.3349881108433251},{"x":2.9000000432133675,"y":0.23924928725561012},{"x":3.0000000447034836,"y":0.14111996380375377},{"x":3.1000000461935997,"y":0.04158061627964135},{"x":3.200000047683716,"y":-0.058374191029984236},{"x":3.300000049173832,"y":-0.15774574270141245},{"x":3.400000050663948,"y":-0.2555411510086444},{"x":3.500000052154064,"y":-0.35078327652964153},{"x":3.6000000536441803,"y":-0.4425204914007219},{"x":3.7000000551342964,"y":-0.529836187667891},{"x":3.8000000566244125,"y":-0.6118579357308002},{"x":3.9000000581145287,"y":-0.6877662013711864},{"x":4.000000059604645,"y":-0.7568025342681227},{"x":4.100000061094761,"y":-0.8182771461831405},{"x":4.200000062584877,"y":-0.8715758030964995},{"x":4.300000064074993,"y":-0.9161659624306573},{"x":4.400000065565109,"y":-0.9516020940398271},{"x":4.500000067055225,"y":-0.9775301318000547},{"x":4.6000000685453415,"y":-0.9936910113209954},{"x":4.700000070035458,"y":-0.9999232584317441},{"x":4.800000071525574,"y":-0.9961646025774231},{"x":4.90000007301569,"y":-0.9824525990060006},{"x":5.000000074505806,"y":-0.9589242535286561},{"x":5.100000075995922,"y":-0.9258146536029626},{"x":5.200000077486038,"y":-0.8834546194166499},{"x":5.300000078976154,"y":-0.8322673984415454},{"x":5.4000000804662704,"y":-0.7727644364846162},{"x":5.500000081956387,"y":-0.7055402674903756},{"x":5.600000083446503,"y":-0.631266573154059},{"x":5.700000084936619,"y":-0.5506854716999542},{"x":5.800000086426735,"y":-0.4646021028811949},{"x":5.900000087916851,"y":-0.3738765832892519},{"x":6.000000089406967,"y":-0.2794154123530115},{"x":6.100000090897083,"y":-0.18216241489586166},{"x":6.200000092387199,"y":-0.0830893107497628},{"x":6.3000000938773155,"y":0.0168139943483945},{"x":6.400000095367432,"y":0.11654929956798761},{"x":6.500000096857548,"y":0.2151200826776971},{"x":6.600000098347664,"y":0.31154145696653224},{"x":6.70000009983778,"y":0.4048500119065797},{"x":6.800000101327896,"y":0.49411343923282436},{"x":6.900000102818012,"y":0.5784398482594302},{"x":7.000000104308128,"y":0.6569866773569186},{"x":7.1000001057982445,"y":0.7289691125497076},{"x":7.200000107288361,"y":0.7936679291181636},{"x":7.300000108778477,"y":0.8504366778544704},{"x":7.400000110268593,"y":0.898708144169618},{"x":7.500000111758709,"y":0.9380000155142486},{"x":7.600000113248825,"y":0.9679197004863622},{"x":7.700000114738941,"y":0.9881682514749484},{"x":7.800000116229057,"y":0.9985433516457859},{"x":7.900000117719173,"y":0.998941336424433},{"x":8.00000011920929,"y":0.9893582292784191},{"x":8.100000120699406,"y":0.9698897814494446},{"x":8.200000122189522,"y":0.9407305152385956},{"x":8.300000123679638,"y":0.9021717804037548},{"x":8.400000125169754,"y":0.8545988430890409},{"x":8.50000012665987,"y":0.7984870363727344},{"x":8.600000128149986,"y":0.7343970108961424},{"x":8.700000129640102,"y":0.6629691330275495},{"x":8.800000131130219,"y":0.584917086532953},{"x":8.900000132620335,"y":0.5010207416835736},{"x":9.00000013411045,"y":0.41211836304966276},{"x":9.100000135600567,"y":0.31909823383776237},{"x":9.200000137090683,"y":0.222889780458267},{"x":9.300000138580799,"y":0.12445428600368272},{"x":9.400000140070915,"y":0.02477528542543854},{"x":9.500000141561031,"y":-0.07515126162252742},{"x":9.600000143051147,"y":-0.17432692208370587},{"x":9.700000144541264,"y":-0.27176076551237605},{"x":9.80000014603138,"y":-0.36647926512335605},{"x":9.900000147521496,"y":-0.45753602495012496}]}],"marks":[{"type":"symbol","from":{"data":"d604fcd7-3072-4872-a662-e69c418a323d"},"properties":{"enter":{"x":{"field":"data.x","scale":"x"},"y":{"field":"data.y","scale":"y"},"fill":{"value":"steelblue"},"fillOpacity":{"value":1}},"update":{"shape":"circle","size":{"value":70},"stroke":{"value":"transparent"}},"hover":{"size":{"value":210},"stroke":{"value":"white"}}}},{"type":"line","from":{"data":"4a73e3f3-739c-4767-be48-f4ca93779c83"},"properties":{"enter":{"x":{"field":"data.x","scale":"x"},"y":{"field":"data.y","scale":"y"},"stroke":{"value":"#FF29D2"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:bottom 20, :top 10, :right 10, :left 50}, :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"d604fcd7-3072-4872-a662-e69c418a323d\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"d604fcd7-3072-4872-a662-e69c418a323d\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}], :data ({:name \"d604fcd7-3072-4872-a662-e69c418a323d\", :values ({:x 0, :y 0.0} {:x 0.5, :y 0.479425538604203} {:x 1.0, :y 0.8414709848078965} {:x 1.5, :y 0.9974949866040544} {:x 2.0, :y 0.9092974268256817} {:x 2.5, :y 0.5984721441039564} {:x 3.0, :y 0.1411200080598672} {:x 3.5, :y -0.35078322768961984} {:x 4.0, :y -0.7568024953079282} {:x 4.5, :y -0.977530117665097} {:x 5.0, :y -0.9589242746631385} {:x 5.5, :y -0.7055403255703919} {:x 6.0, :y -0.27941549819892586} {:x 6.5, :y 0.21511998808781552} {:x 7.0, :y 0.6569865987187891} {:x 7.5, :y 0.9379999767747389} {:x 8.0, :y 0.9893582466233818} {:x 8.5, :y 0.7984871126234903} {:x 9.0, :y 0.4121184852417566} {:x 9.5, :y -0.0751511204618093})} {:name \"4a73e3f3-739c-4767-be48-f4ca93779c83\", :values ({:x 0, :y 0.0} {:x 0.10000000149011612, :y 0.0998334181294999} {:x 0.20000000298023224, :y 0.19866933371588721} {:x 0.30000000447034836, :y 0.29552021093202646} {:x 0.4000000059604645, :y 0.3894183477986018} {:x 0.5000000074505806, :y 0.4794255451427026} {:x 0.6000000089406967, :y 0.5646424807741107} {:x 0.7000000104308128, :y 0.6442176952156167} {:x 0.800000011920929, :y 0.7173560992049138} {:x 0.9000000134110451, :y 0.7833269179639226} {:x 1.0000000149011612, :y 0.8414709928590282} {:x 1.1000000163912773, :y 0.891207367496455} {:x 1.2000000178813934, :y 0.9320390924466878} {:x 1.3000000193715096, :y 0.9635581905990489} {:x 1.4000000208616257, :y 0.9854497335342509} {:x 1.5000000223517418, :y 0.9974949881851538} {:x 1.600000023841858, :y 0.999573602345334} {:x 1.700000025331974, :y 0.991664807188583} {:x 1.8000000268220901, :y 0.9738476247841598} {:x 1.9000000283122063, :y 0.9463000785343733} {:x 2.0000000298023224, :y 0.9092974144235391} {:x 2.1000000312924385, :y 0.8632093508510077} {:x 2.2000000327825546, :y 0.8084963845270198} {:x 2.3000000342726707, :y 0.7457051893416611} {:x 2.400000035762787, :y 0.6754631541798962} {:x 2.500000037252903, :y 0.5984721142590307} {:x 2.600000038743019, :y 0.5155013386230065} {:x 2.7000000402331352, :y 0.42737984386017286} {:x 2.8000000417232513, :y 0.3349881108433251} {:x 2.9000000432133675, :y 0.23924928725561012} {:x 3.0000000447034836, :y 0.14111996380375377} {:x 3.1000000461935997, :y 0.04158061627964135} {:x 3.200000047683716, :y -0.058374191029984236} {:x 3.300000049173832, :y -0.15774574270141245} {:x 3.400000050663948, :y -0.2555411510086444} {:x 3.500000052154064, :y -0.35078327652964153} {:x 3.6000000536441803, :y -0.4425204914007219} {:x 3.7000000551342964, :y -0.529836187667891} {:x 3.8000000566244125, :y -0.6118579357308002} {:x 3.9000000581145287, :y -0.6877662013711864} {:x 4.000000059604645, :y -0.7568025342681227} {:x 4.100000061094761, :y -0.8182771461831405} {:x 4.200000062584877, :y -0.8715758030964995} {:x 4.300000064074993, :y -0.9161659624306573} {:x 4.400000065565109, :y -0.9516020940398271} {:x 4.500000067055225, :y -0.9775301318000547} {:x 4.6000000685453415, :y -0.9936910113209954} {:x 4.700000070035458, :y -0.9999232584317441} {:x 4.800000071525574, :y -0.9961646025774231} {:x 4.90000007301569, :y -0.9824525990060006} {:x 5.000000074505806, :y -0.9589242535286561} {:x 5.100000075995922, :y -0.9258146536029626} {:x 5.200000077486038, :y -0.8834546194166499} {:x 5.300000078976154, :y -0.8322673984415454} {:x 5.4000000804662704, :y -0.7727644364846162} {:x 5.500000081956387, :y -0.7055402674903756} {:x 5.600000083446503, :y -0.631266573154059} {:x 5.700000084936619, :y -0.5506854716999542} {:x 5.800000086426735, :y -0.4646021028811949} {:x 5.900000087916851, :y -0.3738765832892519} {:x 6.000000089406967, :y -0.2794154123530115} {:x 6.100000090897083, :y -0.18216241489586166} {:x 6.200000092387199, :y -0.0830893107497628} {:x 6.3000000938773155, :y 0.0168139943483945} {:x 6.400000095367432, :y 0.11654929956798761} {:x 6.500000096857548, :y 0.2151200826776971} {:x 6.600000098347664, :y 0.31154145696653224} {:x 6.70000009983778, :y 0.4048500119065797} {:x 6.800000101327896, :y 0.49411343923282436} {:x 6.900000102818012, :y 0.5784398482594302} {:x 7.000000104308128, :y 0.6569866773569186} {:x 7.1000001057982445, :y 0.7289691125497076} {:x 7.200000107288361, :y 0.7936679291181636} {:x 7.300000108778477, :y 0.8504366778544704} {:x 7.400000110268593, :y 0.898708144169618} {:x 7.500000111758709, :y 0.9380000155142486} {:x 7.600000113248825, :y 0.9679197004863622} {:x 7.700000114738941, :y 0.9881682514749484} {:x 7.800000116229057, :y 0.9985433516457859} {:x 7.900000117719173, :y 0.998941336424433} {:x 8.00000011920929, :y 0.9893582292784191} {:x 8.100000120699406, :y 0.9698897814494446} {:x 8.200000122189522, :y 0.9407305152385956} {:x 8.300000123679638, :y 0.9021717804037548} {:x 8.400000125169754, :y 0.8545988430890409} {:x 8.50000012665987, :y 0.7984870363727344} {:x 8.600000128149986, :y 0.7343970108961424} {:x 8.700000129640102, :y 0.6629691330275495} {:x 8.800000131130219, :y 0.584917086532953} {:x 8.900000132620335, :y 0.5010207416835736} {:x 9.00000013411045, :y 0.41211836304966276} {:x 9.100000135600567, :y 0.31909823383776237} {:x 9.200000137090683, :y 0.222889780458267} {:x 9.300000138580799, :y 0.12445428600368272} {:x 9.400000140070915, :y 0.02477528542543854} {:x 9.500000141561031, :y -0.07515126162252742} {:x 9.600000143051147, :y -0.17432692208370587} {:x 9.700000144541264, :y -0.27176076551237605} {:x 9.80000014603138, :y -0.36647926512335605} {:x 9.900000147521496, :y -0.45753602495012496})}), :marks ({:type \"symbol\", :from {:data \"d604fcd7-3072-4872-a662-e69c418a323d\"}, :properties {:enter {:x {:field \"data.x\", :scale \"x\"}, :y {:field \"data.y\", :scale \"y\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 1}}, :update {:shape \"circle\", :size {:value 70}, :stroke {:value \"transparent\"}}, :hover {:size {:value 210}, :stroke {:value \"white\"}}}} {:type \"line\", :from {:data \"4a73e3f3-739c-4767-be48-f4ca93779c83\"}, :properties {:enter {:x {:field \"data.x\", :scale \"x\"}, :y {:field \"data.y\", :scale \"y\"}, :stroke {:value \"#FF29D2\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}})}}"}
;; <=

;; @@
;; A function that extracts a set of coordinates from every scored individual.
(defn extract-coords
  [indv]
 (list (:score-2 indv) (:score-1 indv)))
;; @@

;; @@
;; Apply extract-coords to every individual.
(def points (map #(extract-coords %) scored-individuals))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/points</span>","value":"#'user/points"}
;; <=

;; @@
;; Generate a set of coordinates for every individual from the final generation that lies on the Pareto front.
(def pareto-front-points (distinct (map #(extract-coords %) pareto-front-individuals)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;user/pareto-front-points</span>","value":"#'user/pareto-front-points"}
;; <=

;; @@
(list-plot pareto-front-points)
;; @@
;; =>
;;; {"type":"vega","content":{"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"8577d087-6903-412b-ac16-c938155d10ef","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"8577d087-6903-412b-ac16-c938155d10ef","field":"data.y"}}],"marks":[{"type":"symbol","from":{"data":"8577d087-6903-412b-ac16-c938155d10ef"},"properties":{"enter":{"x":{"field":"data.x","scale":"x"},"y":{"field":"data.y","scale":"y"},"fill":{"value":"steelblue"},"fillOpacity":{"value":1}},"update":{"shape":"circle","size":{"value":70},"stroke":{"value":"transparent"}},"hover":{"size":{"value":210},"stroke":{"value":"white"}}}}],"data":[{"name":"8577d087-6903-412b-ac16-c938155d10ef","values":[{"x":-63,"y":-1.7935043117127256},{"x":-3,"y":-47.45125},{"x":-13,"y":-12.442225249636866},{"x":-5,"y":-47.04936358274067},{"x":-9,"y":-29.9812886647479},{"x":-59,"y":-1.8817645419096047},{"x":-11,"y":-23.63565601333672},{"x":-15,"y":-9.101273453581712},{"x":-17,"y":-4.425298601313697},{"x":-1,"y":-51.769534515752774},{"x":-7,"y":-44.25326031059944}]}],"width":400,"height":247.2187957763672,"padding":{"bottom":20,"top":10,"right":10,"left":50}},"value":"#gorilla_repl.vega.VegaView{:content {:axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"8577d087-6903-412b-ac16-c938155d10ef\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"8577d087-6903-412b-ac16-c938155d10ef\", :field \"data.y\"}}], :marks [{:type \"symbol\", :from {:data \"8577d087-6903-412b-ac16-c938155d10ef\"}, :properties {:enter {:x {:field \"data.x\", :scale \"x\"}, :y {:field \"data.y\", :scale \"y\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 1}}, :update {:shape \"circle\", :size {:value 70}, :stroke {:value \"transparent\"}}, :hover {:size {:value 210}, :stroke {:value \"white\"}}}}], :data [{:name \"8577d087-6903-412b-ac16-c938155d10ef\", :values ({:x -63, :y -1.7935043117127256} {:x -3, :y -47.45125} {:x -13, :y -12.442225249636866} {:x -5, :y -47.04936358274067} {:x -9, :y -29.9812886647479} {:x -59, :y -1.8817645419096047} {:x -11, :y -23.63565601333672} {:x -15, :y -9.101273453581712} {:x -17, :y -4.425298601313697} {:x -1, :y -51.769534515752774} {:x -7, :y -44.25326031059944})}], :width 400, :height 247.2188, :padding {:bottom 20, :top 10, :right 10, :left 50}}}"}
;; <=

;; @@
(def sorted-pareto-front-individuals
(sort-by (juxt :score-2 :score-1) pareto-front-individuals))
(apply max-key :score-1 pareto-front-individuals)

;note need to remove indistinct expressions!!!
       
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-map'>{<span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:fitness</span>","value":":fitness"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"}],"value":"[:fitness 0]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:dominated</span>","value":":dominated"},{"type":"html","content":"<span class='clj-unkown'>false</span>","value":"false"}],"value":"[:dominated false]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:score-2</span>","value":":score-2"},{"type":"html","content":"<span class='clj-long'>-63</span>","value":"-63"}],"value":"[:score-2 -63]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:score-1</span>","value":":score-1"},{"type":"html","content":"<span class='clj-double'>-1.7935043117127256</span>","value":"-1.7935043117127256"}],"value":"[:score-1 -1.7935043117127256]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:expr</span>","value":":expr"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>-</span>","value":"-"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-double'>0.1818464559870514</span>","value":"0.1818464559870514"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>+</span>","value":"+"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>+</span>","value":"+"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"}],"value":"(+ x x)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>+</span>","value":"+"},{"type":"html","content":"<span class='clj-double'>1.962818724084773</span>","value":"1.962818724084773"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>+</span>","value":"+"},{"type":"html","content":"<span class='clj-double'>1.8295322555339828</span>","value":"1.8295322555339828"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-double'>0.07971281277150855</span>","value":"0.07971281277150855"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>-</span>","value":"-"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-double'>0.24254057028069043</span>","value":"0.24254057028069043"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>+</span>","value":"+"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"html","content":"<span class='clj-double'>0.24254057028069043</span>","value":"0.24254057028069043"}],"value":"(* x 0.24254057028069043)"}],"value":"(+ x (* x 0.24254057028069043))"}],"value":"(* 0.24254057028069043 (+ x (* x 0.24254057028069043)))"},{"type":"html","content":"<span class='clj-double'>1.734125814815273</span>","value":"1.734125814815273"}],"value":"(- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)"}],"value":"(* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273))"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>-</span>","value":"-"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"html","content":"<span class='clj-double'>0.1818464559870514</span>","value":"0.1818464559870514"}],"value":"(* x 0.1818464559870514)"},{"type":"html","content":"<span class='clj-double'>1.145268972770002</span>","value":"1.145268972770002"}],"value":"(- (* x 0.1818464559870514) 1.145268972770002)"}],"value":"(* x (- (* x 0.1818464559870514) 1.145268972770002))"}],"value":"(* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002)))"}],"value":"(* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002))))"}],"value":"(* 0.07971281277150855 (* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002)))))"}],"value":"(+ 1.8295322555339828 (* 0.07971281277150855 (* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002))))))"}],"value":"(+ 1.962818724084773 (+ 1.8295322555339828 (* 0.07971281277150855 (* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002)))))))"}],"value":"(+ (+ x x) (+ 1.962818724084773 (+ 1.8295322555339828 (* 0.07971281277150855 (* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002))))))))"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-double'>1.8295322555339828</span>","value":"1.8295322555339828"},{"type":"html","content":"<span class='clj-double'>0.24254057028069043</span>","value":"0.24254057028069043"}],"value":"(* 1.8295322555339828 0.24254057028069043)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>-</span>","value":"-"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"html","content":"<span class='clj-double'>0.07971281277150855</span>","value":"0.07971281277150855"}],"value":"(* x 0.07971281277150855)"}],"value":"(* x (* x 0.07971281277150855))"},{"type":"html","content":"<span class='clj-double'>1.734125814815273</span>","value":"1.734125814815273"}],"value":"(- (* x (* x 0.07971281277150855)) 1.734125814815273)"}],"value":"(* x (- (* x (* x 0.07971281277150855)) 1.734125814815273))"}],"value":"(* (* 1.8295322555339828 0.24254057028069043) (* x (- (* x (* x 0.07971281277150855)) 1.734125814815273)))"}],"value":"(* (+ (+ x x) (+ 1.962818724084773 (+ 1.8295322555339828 (* 0.07971281277150855 (* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002)))))))) (* (* 1.8295322555339828 0.24254057028069043) (* x (- (* x (* x 0.07971281277150855)) 1.734125814815273))))"}],"value":"(* 0.1818464559870514 (* (+ (+ x x) (+ 1.962818724084773 (+ 1.8295322555339828 (* 0.07971281277150855 (* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002)))))))) (* (* 1.8295322555339828 0.24254057028069043) (* x (- (* x (* x 0.07971281277150855)) 1.734125814815273)))))"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>+</span>","value":"+"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>-</span>","value":"-"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>+</span>","value":"+"},{"type":"html","content":"<span class='clj-double'>1.8295322555339828</span>","value":"1.8295322555339828"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"}],"value":"(+ 1.8295322555339828 x)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>-</span>","value":"-"},{"type":"html","content":"<span class='clj-double'>1.145268972770002</span>","value":"1.145268972770002"},{"type":"html","content":"<span class='clj-double'>1.4772456434167047</span>","value":"1.4772456434167047"}],"value":"(- 1.145268972770002 1.4772456434167047)"}],"value":"(- (+ 1.8295322555339828 x) (- 1.145268972770002 1.4772456434167047))"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>-</span>","value":"-"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>*</span>","value":"*"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"html","content":"<span class='clj-double'>0.1818464559870514</span>","value":"0.1818464559870514"}],"value":"(* x 0.1818464559870514)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-symbol'>+</span>","value":"+"},{"type":"html","content":"<span class='clj-symbol'>x</span>","value":"x"},{"type":"html","content":"<span class='clj-double'>1.734125814815273</span>","value":"1.734125814815273"}],"value":"(+ x 1.734125814815273)"}],"value":"(- (* x 0.1818464559870514) (+ x 1.734125814815273))"}],"value":"(+ (- (+ 1.8295322555339828 x) (- 1.145268972770002 1.4772456434167047)) (- (* x 0.1818464559870514) (+ x 1.734125814815273)))"}],"value":"(- (* 0.1818464559870514 (* (+ (+ x x) (+ 1.962818724084773 (+ 1.8295322555339828 (* 0.07971281277150855 (* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002)))))))) (* (* 1.8295322555339828 0.24254057028069043) (* x (- (* x (* x 0.07971281277150855)) 1.734125814815273))))) (+ (- (+ 1.8295322555339828 x) (- 1.145268972770002 1.4772456434167047)) (- (* x 0.1818464559870514) (+ x 1.734125814815273))))"}],"value":"[:expr (- (* 0.1818464559870514 (* (+ (+ x x) (+ 1.962818724084773 (+ 1.8295322555339828 (* 0.07971281277150855 (* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002)))))))) (* (* 1.8295322555339828 0.24254057028069043) (* x (- (* x (* x 0.07971281277150855)) 1.734125814815273))))) (+ (- (+ 1.8295322555339828 x) (- 1.145268972770002 1.4772456434167047)) (- (* x 0.1818464559870514) (+ x 1.734125814815273))))]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:archived</span>","value":":archived"},{"type":"html","content":"<span class='clj-unkown'>false</span>","value":"false"}],"value":"[:archived false]"}],"value":"{:fitness 0, :dominated false, :score-2 -63, :score-1 -1.7935043117127256, :expr (- (* 0.1818464559870514 (* (+ (+ x x) (+ 1.962818724084773 (+ 1.8295322555339828 (* 0.07971281277150855 (* x (* (* x (- (* 0.24254057028069043 (+ x (* x 0.24254057028069043))) 1.734125814815273)) (* x (- (* x 0.1818464559870514) 1.145268972770002)))))))) (* (* 1.8295322555339828 0.24254057028069043) (* x (- (* x (* x 0.07971281277150855)) 1.734125814815273))))) (+ (- (+ 1.8295322555339828 x) (- 1.145268972770002 1.4772456434167047)) (- (* x 0.1818464559870514) (+ x 1.734125814815273)))), :archived false}"}
;; <=

;; @@
(plot (functionalise (:expr (nth  sorted-pareto-front-individuals 0))) [-5 7])
;; @@
;; =>
;;; {"type":"vega","content":{"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"5f934751-d6c8-4738-8086-f90e60eb7883","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"5f934751-d6c8-4738-8086-f90e60eb7883","field":"data.y"}}],"marks":[{"type":"line","from":{"data":"5f934751-d6c8-4738-8086-f90e60eb7883"},"properties":{"enter":{"x":{"field":"data.x","scale":"x"},"y":{"field":"data.y","scale":"y"},"stroke":{"value":"#FF29D2"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}],"data":[{"name":"5f934751-d6c8-4738-8086-f90e60eb7883","values":[{"x":-5,"y":8.054514296325335},{"x":-4.880000002682209,"y":4.747469937616568},{"x":-4.760000005364418,"y":2.1108803061695793},{"x":-4.640000008046627,"y":0.046248852304117904},{"x":-4.520000010728836,"y":-1.533753913830753},{"x":-4.400000013411045,"y":-2.706260123948701},{"x":-4.280000016093254,"y":-3.539113301846474},{"x":-4.160000018775463,"y":-4.091718632989094},{"x":-4.040000021457672,"y":-4.415837175582627},{"x":-3.920000024139881,"y":-4.556326386542743},{"x":-3.80000002682209,"y":-4.551829287053234},{"x":-3.680000029504299,"y":-4.435414543694307},{"x":-3.560000032186508,"y":-4.235169692406367},{"x":-3.440000034868717,"y":-3.9747496838406446},{"x":-3.320000037550926,"y":-3.6738828799339145},{"x":-3.2000000402331352,"y":-3.3488365828302658},{"x":-3.0800000429153442,"y":-3.012844128558649},{"x":-2.9600000455975533,"y":-2.6764955291607655},{"x":-2.8400000482797623,"y":-2.3480935982495437},{"x":-2.7200000509619713,"y":-2.033977446264306},{"x":-2.6000000536441803,"y":-1.7388151829744716},{"x":-2.4800000563263893,"y":-1.465867616069389},{"x":-2.3600000590085983,"y":-1.21722468595772},{"x":-2.2400000616908073,"y":-0.9940163281855265},{"x":-2.1200000643730164,"y":-0.7965994061680051},{"x":-2.0000000670552254,"y":-0.6247223082155938},{"x":-1.8800000697374344,"y":-0.47766875412093224},{"x":-1.7600000724196434,"y":-0.35438230785894875},{"x":-1.6400000751018524,"y":-0.2535730442381108},{"x":-1.5200000777840614,"y":-0.17380776862665498},{"x":-1.4000000804662704,"y":-0.11358514016338628},{"x":-1.2800000831484795,"y":-0.07139700014840877},{"x":-1.1600000858306885,"y":-0.04577715859492687},{"x":-1.0400000885128975,"y":-0.03533884320902994},{"x":-0.9200000911951065,"y":-0.038801966350147044},{"x":-0.8000000938773155,"y":-0.05501131681063351},{"x":-0.6800000965595245,"y":-0.08294673453872478},{"x":-0.5600000992417336,"y":-0.12172627771486919},{"x":-0.44000010192394257,"y":-0.17060334287722276},{"x":-0.3200001046061516,"y":-0.2289586500778676},{"x":-0.2000001072883606,"y":-0.29628795633708593},{"x":-0.08000010997056961,"y":-0.37218631194879886},{"x":0.039999887347221375,"y":-0.4563296254760525},{"x":0.15999988466501236,"y":-0.5484542545612084},{"x":0.27999988198280334,"y":-0.6483352909612715},{"x":0.39999987930059433,"y":-0.7557641595045572},{"x":0.5199998766183853,"y":-0.8705261019506849},{"x":0.6399998739361763,"y":-0.9923780680216484},{"x":0.7599998712539673,"y":-1.1210274871574915},{"x":0.8799998685717583,"y":-1.256112345835898},{"x":0.9999998658895493,"y":-1.3971829465807697},{"x":1.1199998632073402,"y":-1.5436856760706485},{"x":1.2399998605251312,"y":-1.6949490610436049},{"x":1.3599998578429222,"y":-1.8501723419810039},{"x":1.4799998551607132,"y":-2.0084167458383115},{"x":1.5999998524785042,"y":-2.1685995903769095},{"x":1.7199998497962952,"y":-2.3294913039366234},{"x":1.8399998471140862,"y":-2.489715395774481},{"x":1.9599998444318771,"y":-2.6477513633809675},{"x":2.079999841749668,"y":-2.80194047447082},{"x":2.199999839067459,"y":-2.950494312631205},{"x":2.31999983638525,"y":-3.0915059268958456},{"x":2.439999833703041,"y":-3.222963376799497},{"x":2.559999831020832,"y":-3.342765415752907},{"x":2.679999828338623,"y":-3.448739006864176},{"x":2.799999825656414,"y":-3.538658316618222},{"x":2.919999822974205,"y":-3.610264783111818},{"x":3.039999820291996,"y":-3.661287806827433},{"x":3.159999817609787,"y":-3.6894655632149242},{"x":3.279999814927578,"y":-3.6925653876358386},{"x":3.399999812245369,"y":-3.668403134510914},{"x":3.51999980956316,"y":-3.614860863797125},{"x":3.639999806880951,"y":-3.5299021592063657},{"x":3.759999804198742,"y":-3.411584333863685},{"x":3.879999801516533,"y":-3.25806673038873},{"x":3.999999798834324,"y":-3.0676142736698386},{"x":4.119999796152115,"y":-2.8385953858859856},{"x":4.239999793469906,"y":-2.569473324617597},{"x":4.359999790787697,"y":-2.2587899561729605},{"x":4.479999788105488,"y":-1.905140927542802},{"x":4.599999785423279,"y":-1.5071411516813236},{"x":4.71999978274107,"y":-1.0633794720977838},{"x":4.839999780058861,"y":-0.5723613240285058},{"x":4.959999777376652,"y":-0.032438160744914235},{"x":5.079999774694443,"y":0.5582776351609504},{"x":5.199999772012234,"y":1.202013684386292},{"x":5.319999769330025,"y":1.901455765009811},{"x":5.439999766647816,"y":2.659884614367619},{"x":5.559999763965607,"y":3.481332853728322},{"x":5.679999761283398,"y":4.370763559496971},{"x":5.799999758601189,"y":5.3342720533918335},{"x":5.91999975591898,"y":6.379312532752147},{"x":6.039999753236771,"y":7.514951210849279},{"x":6.159999750554562,"y":8.752147685787849},{"x":6.279999747872353,"y":10.104066305297746},{"x":6.399999745190144,"y":11.586419343432016},{"x":6.519999742507935,"y":13.217843853900014},{"x":6.6399997398257256,"y":15.020314113479245},{"x":6.7599997371435165,"y":17.019591617663714},{"x":6.8799997344613075,"y":19.245714639420772},{"x":6.9999997317790985,"y":21.73352941064254}]}],"width":400,"height":247.2187957763672,"padding":{"bottom":20,"top":10,"right":10,"left":50}},"value":"#gorilla_repl.vega.VegaView{:content {:axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"5f934751-d6c8-4738-8086-f90e60eb7883\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"5f934751-d6c8-4738-8086-f90e60eb7883\", :field \"data.y\"}}], :marks [{:type \"line\", :from {:data \"5f934751-d6c8-4738-8086-f90e60eb7883\"}, :properties {:enter {:x {:field \"data.x\", :scale \"x\"}, :y {:field \"data.y\", :scale \"y\"}, :stroke {:value \"#FF29D2\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}}], :data [{:name \"5f934751-d6c8-4738-8086-f90e60eb7883\", :values ({:x -5, :y 8.054514296325335} {:x -4.880000002682209, :y 4.747469937616568} {:x -4.760000005364418, :y 2.1108803061695793} {:x -4.640000008046627, :y 0.046248852304117904} {:x -4.520000010728836, :y -1.533753913830753} {:x -4.400000013411045, :y -2.706260123948701} {:x -4.280000016093254, :y -3.539113301846474} {:x -4.160000018775463, :y -4.091718632989094} {:x -4.040000021457672, :y -4.415837175582627} {:x -3.920000024139881, :y -4.556326386542743} {:x -3.80000002682209, :y -4.551829287053234} {:x -3.680000029504299, :y -4.435414543694307} {:x -3.560000032186508, :y -4.235169692406367} {:x -3.440000034868717, :y -3.9747496838406446} {:x -3.320000037550926, :y -3.6738828799339145} {:x -3.2000000402331352, :y -3.3488365828302658} {:x -3.0800000429153442, :y -3.012844128558649} {:x -2.9600000455975533, :y -2.6764955291607655} {:x -2.8400000482797623, :y -2.3480935982495437} {:x -2.7200000509619713, :y -2.033977446264306} {:x -2.6000000536441803, :y -1.7388151829744716} {:x -2.4800000563263893, :y -1.465867616069389} {:x -2.3600000590085983, :y -1.21722468595772} {:x -2.2400000616908073, :y -0.9940163281855265} {:x -2.1200000643730164, :y -0.7965994061680051} {:x -2.0000000670552254, :y -0.6247223082155938} {:x -1.8800000697374344, :y -0.47766875412093224} {:x -1.7600000724196434, :y -0.35438230785894875} {:x -1.6400000751018524, :y -0.2535730442381108} {:x -1.5200000777840614, :y -0.17380776862665498} {:x -1.4000000804662704, :y -0.11358514016338628} {:x -1.2800000831484795, :y -0.07139700014840877} {:x -1.1600000858306885, :y -0.04577715859492687} {:x -1.0400000885128975, :y -0.03533884320902994} {:x -0.9200000911951065, :y -0.038801966350147044} {:x -0.8000000938773155, :y -0.05501131681063351} {:x -0.6800000965595245, :y -0.08294673453872478} {:x -0.5600000992417336, :y -0.12172627771486919} {:x -0.44000010192394257, :y -0.17060334287722276} {:x -0.3200001046061516, :y -0.2289586500778676} {:x -0.2000001072883606, :y -0.29628795633708593} {:x -0.08000010997056961, :y -0.37218631194879886} {:x 0.039999887347221375, :y -0.4563296254760525} {:x 0.15999988466501236, :y -0.5484542545612084} {:x 0.27999988198280334, :y -0.6483352909612715} {:x 0.39999987930059433, :y -0.7557641595045572} {:x 0.5199998766183853, :y -0.8705261019506849} {:x 0.6399998739361763, :y -0.9923780680216484} {:x 0.7599998712539673, :y -1.1210274871574915} {:x 0.8799998685717583, :y -1.256112345835898} {:x 0.9999998658895493, :y -1.3971829465807697} {:x 1.1199998632073402, :y -1.5436856760706485} {:x 1.2399998605251312, :y -1.6949490610436049} {:x 1.3599998578429222, :y -1.8501723419810039} {:x 1.4799998551607132, :y -2.0084167458383115} {:x 1.5999998524785042, :y -2.1685995903769095} {:x 1.7199998497962952, :y -2.3294913039366234} {:x 1.8399998471140862, :y -2.489715395774481} {:x 1.9599998444318771, :y -2.6477513633809675} {:x 2.079999841749668, :y -2.80194047447082} {:x 2.199999839067459, :y -2.950494312631205} {:x 2.31999983638525, :y -3.0915059268958456} {:x 2.439999833703041, :y -3.222963376799497} {:x 2.559999831020832, :y -3.342765415752907} {:x 2.679999828338623, :y -3.448739006864176} {:x 2.799999825656414, :y -3.538658316618222} {:x 2.919999822974205, :y -3.610264783111818} {:x 3.039999820291996, :y -3.661287806827433} {:x 3.159999817609787, :y -3.6894655632149242} {:x 3.279999814927578, :y -3.6925653876358386} {:x 3.399999812245369, :y -3.668403134510914} {:x 3.51999980956316, :y -3.614860863797125} {:x 3.639999806880951, :y -3.5299021592063657} {:x 3.759999804198742, :y -3.411584333863685} {:x 3.879999801516533, :y -3.25806673038873} {:x 3.999999798834324, :y -3.0676142736698386} {:x 4.119999796152115, :y -2.8385953858859856} {:x 4.239999793469906, :y -2.569473324617597} {:x 4.359999790787697, :y -2.2587899561729605} {:x 4.479999788105488, :y -1.905140927542802} {:x 4.599999785423279, :y -1.5071411516813236} {:x 4.71999978274107, :y -1.0633794720977838} {:x 4.839999780058861, :y -0.5723613240285058} {:x 4.959999777376652, :y -0.032438160744914235} {:x 5.079999774694443, :y 0.5582776351609504} {:x 5.199999772012234, :y 1.202013684386292} {:x 5.319999769330025, :y 1.901455765009811} {:x 5.439999766647816, :y 2.659884614367619} {:x 5.559999763965607, :y 3.481332853728322} {:x 5.679999761283398, :y 4.370763559496971} {:x 5.799999758601189, :y 5.3342720533918335} {:x 5.91999975591898, :y 6.379312532752147} {:x 6.039999753236771, :y 7.514951210849279} {:x 6.159999750554562, :y 8.752147685787849} {:x 6.279999747872353, :y 10.104066305297746} {:x 6.399999745190144, :y 11.586419343432016} {:x 6.519999742507935, :y 13.217843853900014} {:x 6.6399997398257256, :y 15.020314113479245} {:x 6.7599997371435165, :y 17.019591617663714} {:x 6.8799997344613075, :y 19.245714639420772} {:x 6.9999997317790985, :y 21.73352941064254})}], :width 400, :height 247.2188, :padding {:bottom 20, :top 10, :right 10, :left 50}}}"}
;; <=

;; @@
pareto-front-points
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-lazy-seq'>(<span>","close":"<span class='clj-lazy-seq'>)</span>","separator":" ","items":[{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-5</span>","value":"-5"},{"type":"html","content":"<span class='clj-double'>-47.0875570880259</span>","value":"-47.0875570880259"}],"value":"(-5 -47.0875570880259)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-71</span>","value":"-71"},{"type":"html","content":"<span class='clj-double'>-1.8867304549096637</span>","value":"-1.8867304549096637"}],"value":"(-71 -1.8867304549096637)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-3</span>","value":"-3"},{"type":"html","content":"<span class='clj-double'>-47.45125</span>","value":"-47.45125"}],"value":"(-3 -47.45125)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-17</span>","value":"-17"},{"type":"html","content":"<span class='clj-double'>-5.605203461612983</span>","value":"-5.605203461612983"}],"value":"(-17 -5.605203461612983)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-51</span>","value":"-51"},{"type":"html","content":"<span class='clj-double'>-4.830887000932439</span>","value":"-4.830887000932439"}],"value":"(-51 -4.830887000932439)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-9</span>","value":"-9"},{"type":"html","content":"<span class='clj-double'>-29.9812886647479</span>","value":"-29.9812886647479"}],"value":"(-9 -29.9812886647479)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-55</span>","value":"-55"},{"type":"html","content":"<span class='clj-double'>-4.828501247647969</span>","value":"-4.828501247647969"}],"value":"(-55 -4.828501247647969)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-49</span>","value":"-49"},{"type":"html","content":"<span class='clj-double'>-4.845160525358769</span>","value":"-4.845160525358769"}],"value":"(-49 -4.845160525358769)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-57</span>","value":"-57"},{"type":"html","content":"<span class='clj-double'>-4.827512766506526</span>","value":"-4.827512766506526"}],"value":"(-57 -4.827512766506526)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-11</span>","value":"-11"},{"type":"html","content":"<span class='clj-double'>-23.63565601333672</span>","value":"-23.63565601333672"}],"value":"(-11 -23.63565601333672)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-53</span>","value":"-53"},{"type":"html","content":"<span class='clj-double'>-4.829435219577398</span>","value":"-4.829435219577398"}],"value":"(-53 -4.829435219577398)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-15</span>","value":"-15"},{"type":"html","content":"<span class='clj-double'>-9.101273453581712</span>","value":"-9.101273453581712"}],"value":"(-15 -9.101273453581712)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-13</span>","value":"-13"},{"type":"html","content":"<span class='clj-double'>-12.781571615211993</span>","value":"-12.781571615211993"}],"value":"(-13 -12.781571615211993)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-43</span>","value":"-43"},{"type":"html","content":"<span class='clj-double'>-4.847816338770646</span>","value":"-4.847816338770646"}],"value":"(-43 -4.847816338770646)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-69</span>","value":"-69"},{"type":"html","content":"<span class='clj-double'>-1.9345990120456678</span>","value":"-1.9345990120456678"}],"value":"(-69 -1.9345990120456678)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-1</span>","value":"-1"},{"type":"html","content":"<span class='clj-double'>-51.769534515752774</span>","value":"-51.769534515752774"}],"value":"(-1 -51.769534515752774)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-59</span>","value":"-59"},{"type":"html","content":"<span class='clj-double'>-2.335334211105223</span>","value":"-2.335334211105223"}],"value":"(-59 -2.335334211105223)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-63</span>","value":"-63"},{"type":"html","content":"<span class='clj-double'>-1.98452534773357</span>","value":"-1.98452534773357"}],"value":"(-63 -1.98452534773357)"},{"type":"list-like","open":"<span class='clj-list'>(<span>","close":"<span class='clj-list'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>-7</span>","value":"-7"},{"type":"html","content":"<span class='clj-double'>-44.25326031059944</span>","value":"-44.25326031059944"}],"value":"(-7 -44.25326031059944)"}],"value":"((-5 -47.0875570880259) (-71 -1.8867304549096637) (-3 -47.45125) (-17 -5.605203461612983) (-51 -4.830887000932439) (-9 -29.9812886647479) (-55 -4.828501247647969) (-49 -4.845160525358769) (-57 -4.827512766506526) (-11 -23.63565601333672) (-53 -4.829435219577398) (-15 -9.101273453581712) (-13 -12.781571615211993) (-43 -4.847816338770646) (-69 -1.9345990120456678) (-1 -51.769534515752774) (-59 -2.335334211105223) (-63 -1.98452534773357) (-7 -44.25326031059944))"}
;; <=

;; @@

;; @@

;; @@

;; @@

;; @@

;; @@
